import { Buffer } from "node:buffer";

import { cnt } from "./gost.js"

const raw = "Уровень культуры мужчины определяется его отношением к женщине."
const encoder = new TextEncoder();
const DATA = encoder.encode(raw);
const KEY = new Uint8Array(Buffer.from("0779721958783071038427195875486813235948738003045421697717189300", "hex"))

const SBOX = [
    [0x4, 0x4, 0x3, 0xc, 0x1, 0xb, 0x2, 0xa, 0xd, 0x3, 0xa, 0x4, 0x0, 0x3, 0xe, 0xd],
    [0xc, 0x4, 0x1, 0x4, 0xb, 0xe, 0xa, 0x3, 0xa, 0xa, 0x1, 0xf, 0xd, 0x4, 0xb, 0x3],
    [0x2, 0xb, 0x3, 0x1, 0xa, 0xb, 0xc, 0x0, 0x0, 0xa, 0x4, 0xf, 0x2, 0xc, 0xc, 0x0],
    [0xb, 0xc, 0x3, 0xa, 0x0, 0xa, 0xf, 0x3, 0xf, 0x4, 0x1, 0xc, 0xf, 0x0, 0xe, 0xb],
    [0x0, 0xd, 0xd, 0x1, 0x1, 0x1, 0xc, 0xe, 0x4, 0xa, 0x3, 0x0, 0x0, 0xb, 0x0, 0xd],
    [0xb, 0xc, 0xc, 0xf, 0x4, 0xc, 0x2, 0x3, 0x0, 0xc, 0x2, 0x0, 0xc, 0xf, 0x0, 0x2],
    [0xe, 0xe, 0xf, 0xf, 0xc, 0xb, 0xd, 0x2, 0x2, 0xb, 0x2, 0xb, 0xb, 0x4, 0xe, 0xa],
    [0x1, 0xe, 0x2, 0xd, 0x1, 0x4, 0xf, 0x0, 0x0, 0xd, 0xe, 0x0, 0xd, 0x0, 0x4, 0x2]
]

const encrypted = cnt(KEY, DATA, SBOX);

console.log(encrypted);
const decrypted = cnt(KEY, encrypted, SBOX);
console.log(new TextDecoder("utf-8").decode(decrypted));